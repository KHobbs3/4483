# Compiled Results:
# TEST
### Biplots:
mothur:
  - still small PC1 and PC2 values for mothur output
  - lots of overlap between subgroups in biplot
  - presence of uncoloured points in biplot - does this mean there are extra samples that were not subsetted?
    - yes, 105 samples that had SVs generated from 454 sequencing were removed so that only Illumina-generated SVs remained

dada2:
##### Results:
    - samples do not show clear difference between each other. Supported by:
        - low PC value
        - large overlap of ellipses in compositional Space
        - no clear driver shown in loadings (mass is centered around origin (0,0)
        indicating symmetry in data and no presence of OTUs/features
        driving sample variation)

### Count tables:

parameter | mothur | dada2
----------|--------|-------
No. OTUs  | 10620  |
filtering method | OTUs with mean reads >= 1 are kept | count > 10 are kept
No. post-filter | 1191 | 2243


---

## FINDING ERRORS (TECHNICAL AND FPs):
### propR workflow
dada2 output:
  - using a rho value of 0.7 and 0.6 no mean differences in clrs were detected
  - using a rho value of 0.5 detected 6 SV pairs; however, no clr mean differences were significant (>|2|)

mothur output:
    - rho value of 0.7 generated 18 OTU pairs
      - clr differences range from +/- 0.6 to +/- 4.5, indicating presence of technical errors
      - no tax assignments of technical errors corresponded to those with claimed significant difference by published article;
      therefore, false positive assignments by articles are not due to technical sequencing error. Since data transformation was controlled for in the rho analysis of mothur output, the absence of transforming data by Jangi et al
      may have caused the misinterpretation.
      - does table have to be transformed for propr analysis? If not - can validate by performing rho analysis on non-transformed mothur output.

# ****** UPDATED WITH 454 SEQ RMVD:********
    - rho = 0.7, clr = 5
        - no results * why would it make a difference if samples were rmvd but all SVs persisted?

### filtR workflow (updated June 27, 2018)
dada2 output:
  - rho = 0.7, clr cutoff = 5
    - no results generated (rho too high)
  - rho = 0.5, clr cutoff = 5
    - no results (clr too high)
  - rho = 0.5, clr = 4
    - no results (clr too high)
  - rho = 0.5, clr = 3
    - no results (clr too high)

mothur output:
  - rho = 0.7, clr cutoff = 5
    - 2 OTU pairs removed
  - rho = 0.5, clr cutoff = 3


### DESeq2:
  - found the number of significant results for each comparison before and after the benj-hoch adjustment
  dada2:
      adjustment|cvu | cvcop | cvint
      ----------|----|-------|------
      before | 26 | 50 | 36
      after | 20 | 48 | 32

  mothur:
      adjustment|cvu | cvcop | cvint
      ----------|----|-------|------
      before | 14 | 8 | 26
      after | 3 | 0 | 19

---

## FINDING SIGNIFICANT RESULTS
### DESeq2:
  - MA plots:
    dada2:
        - plots look VERY different from those generated by ALDEx2...
        DESeq2 | ALDEx2
        -------|-------
        red points at y lims, no clustering, dispersion as x -> 1e03 | points cluster around zero, disperse as x -> lim
      xlim: (1e-03, 1e03)  | xlim: (0, 12)
      ylim: (-1, 1)  | ylim: (-3, 3)
        - smaller range of log-fold change in DESeq2 than ALDEx2 although points still appear significant
        - larger range of means for DESeq2 results suggest greater variation within data subsets(?)

    mothur:
        - cvint/cvcop: similar shape to dada2, different centre (not centered around zero) and more dense
        - cvu: different shape, high density at ylim = 1
        - both dada2 and mothur have log2fold changes that range from (-1, 1)


    - Dispersion plots:
      parameter | dada2 | mothur
      ----------|-------|-------
      line of fit | horizontal linear until (1e01, 1e02) | asymptotic (horizontal asymptote at y=1e01) with a steep negative slope
      outliers | many at y = 1e02 | few at y = 1e02

### ALDEx2:

---

## POSITIVE CONTROL DATASET RESULTS:
### Dada2
  - err profiles: C2G appears error prone (deviates from trendline) but the remaining transitions/transversions appear to occur as expected
  - quality scores:
    - reads are ~ 250 bp in length
    - forward: consistent q score between 30-40
    - reverse: consistent q score between 30-40 for 150 bp then q dips to ~25 afterwards
  - pipeline results:
          ... | dada2 | QIIME --> USEARCH
          ----|-------|-------
        No. Samples | 24 | 24
        No. SVs | 988 | 1752
        Ref DB | Silva | UCHIME pipeline -> Broad Microbiome Utilitiesâ€™ 16S Gold

### filtR
    rho CO | clr CO | dada2 result
    -------|--------|-------------
    0.7    | 5      | clr too high (NA)
    0.7    | 4      | clr too high (NA)
    0.7    | 3      | clr too high (NA)
    0.7    | 2      | clr too high (NA)
    0.5    | 1      | clr too high (NA)
    0.3    | 1      | clr too high (NA)


    rho CO | clr CO | QIIME result
    -------|--------|-------------
    0.7    | 5      | clr too high (NA)
    0.7    | 4      | clr too high (NA)
    0.7    | 3      | clr too high (NA)
    0.7    | 2      | clr too high (NA)
    0.7    | 1      | clr too high (NA)
    0.5    | 1      | clr too high (NA)
    0.3    | 1      | clr too high (NA)

Possible conclusions:
- Since both QIIME and dada2 count tables did not generate technical errors (according to filtR), it is possible that dada2 found more SVs than QIIME due to its higher resolution.
- The additional SVs may represent biological variation that was falsely clustered using the OTU based approach to processing reads employed by QIIME.


## NEGATIVE CONTROL RESULTS:
### Using tax assignment to identify spike-ins (makes assumption that NA-labelled SVs are spike-ins):
dada2 results:
  ... | "Bacteria:NA:NA:NA:NA:NA" | "NA:NA..."
  ----|---------------------------|----------
  No. of SVs| 187 | 66

Total SVs for dada2 control set: 988


QIIME results:
  - for the QIIME sample set ('control_24_samples_tax') the col containing taxonomic assignments was renamed "tax.vector"
  - must identify how QIIME labels reads without tax assignment
    - all SVs have some classification...`
      - **note that QIIME tax table uses a different ref DB**

Total SVs for mothur control set: 1752

### Using sequences to identify spike-ins:
- Unsuccessful attempts to confirm that the synthetic variable regions were filtered by dada2. This hypothesis is left unconfirmed.
- Both dada2 and QIIME count tables do not include the synthetic variable regions possibly because they are filtered out due to
    - low abundances (most likely)
    - errors? (unlikely)
    - dada2 could have identified them as potential technical errors
